{"version":3,"sources":["main.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourcesContent":["'use strict';\n\n//Primero hacemos las variables\n\nconst searchFilm = document.querySelector('.js_search-films');\nconst button = document.querySelector('.js_button');\nconst reset = document.querySelector('.js_reset');\nconst films = document.querySelector('.js_films');\nconst favoriteFilms = document.querySelector('.js_favorite-films');\nconst defaultImage= 'https://via.placeholder.com/210x295/ffffff/666666/?text=TV';\n\n//Vamos a crear una variable global para el array de los datos del fetch\nlet globalData=[];\n//Tambien crearemos una variable para los favoritos \nlet favorites=[]\n\n\n//Vamos a realizar el Fetch\n  function getFilms(ev){ \n   ev.preventDefault()\n    let search =searchFilm.value;\n   fetch(`//api.tvmaze.com/search/shows?q=${search}`)\n    .then((response) => response.json())\n    .then((data) => {\n       //Le decimos que el array de global data es igual a los datos que nos da el fetch\n      globalData = data;\n      \n    //Añadimos la funcion que pinta las caratulas\n    paintFilms(globalData);\n    });\n    }\n\n //Listener del fetch \n button.addEventListener('click', getFilms);\n\n    //Creamos una función para que se nos pinta las caratulas de las series\n    function paintFilms() {\n       //Cogemos la variable de films, para poder escribir por encima\n       films.innerHTML='';\n      //recorro el array de los datos del fech\n      for (let item of globalData) {\n         //Buscamos que la serie que estamos pintando este o no en los favoritos del usuario.\n         const isValidClass = favorites.find( \n            (favoriteId)=> favoriteId.show.id === item.show.id); \n            //Usamos el metodo find por que nos permite buscar elementos dentro de un array, lo que buscamos es el id de las series\n             \n         //Realizamos un condicional para saber si esta en favoritos\n         let isFavorite= '';\n         if (isValidClass === undefined){\n            isFavorite='';\n        \n         } else{\n            isFavorite='favorito';\n\n         }\n         //Por si la serie no tuviera imagen ponemos \n         if(item.show.image === null){\n            films.innerHTML+=`<li id=\"${item.show.id}\" class=\"js-list_item\" ${isFavorite}\"><div class=\"div_list\"><h2 class=\"tittle_name\">${item.show.name}</h2><img class= \"image\" src=${defaultImage} /></div></li>`;\n         } else{\n           //Si la serie si tiene imagen se tendria que pintar: \n            films.innerHTML += `<li id=\"${item.show.id}\" class=\"js-list_item ${isFavorite}\"><div class=\"div_list\"><h2 class=\"tittle_name\">${item.show.name}</h2><img class=\"image\" src=\"${item.show.image.medium}\"/></div></li>`;\n    }\n    listenCover();  \n  }\n\n}\n//Realizamos una función para desglosar el array de js-list-item (esta clase se la hemos puesto directamente en la funcion de pintar paletas)\nfunction listenCover(){\n   const allCovers=document.querySelectorAll('.js-list_item');\n   for (let cover of allCovers){\n      cover.addEventListener('click', handleClickCover)\n   }\n}\n \n\n //FAVORITOS\n\n function handleClickCover(event) {\n  event.preventDefault();\n \n   //Primero verificamos que li esta siendo elegida por el usuario, ademas de obtener su id\n   const selectedCover = parseInt(event.currentTarget.id);\n   \n  \n   //Buscamos la id en la variable global data (el cual es un array)\n   const filmInfo = globalData.find((filmItem) => filmItem.show.id === selectedCover);\n \n   // Buscar si la caratula esta en favoritos\n   const ifThis = favorites.find(\n     (favoriteId) => favoriteId.show.id === selectedCover\n   );\n  \n  \n   if (ifThis === undefined) {\n     //si la caratula en la que se ha hecho click no está en el array de favoritos: añadimos a favoritos\n     favorites.push(filmInfo);  \n   } else {\n     //Si está, filtramos para ello usamos e metodo .filter\n     favorites = favorites.filter((favoriteId) => favoriteId.show.id !== selectedCover); \n   }\n  \n   printFavorite(); // esta es la función para pintar los favoritos\n  paintFilms();\n    //guardo favoritos en LS\n  setLocalStorage();\n  \n }\n\n //Haremos la función para añadir los favoritos \n function printFavorite() {\n\n   favoriteFilms.innerHTML = '';\n \n    for (const favorite of favorites) {\n      if (favorite.show.image === null) {\n         favoriteFilms.innerHTML += `<li id=\"${favorite.show.id}\" class=\"list__favoritos\"><div class=\"div_favoritos\"><h1 class=\"title_favoritos\">${favorite.show.name}</h1><img class=\"img_favoritos\" src=${defaultImage}/><i id=\"${favorite.show.id}\"></i></div></li>`;\n     } else {\n       favoriteFilms.innerHTML += `<li item-id=\"${favorite.show.id}\" class=\"list_favoritos\"><div class=\"div_favoritos\"><h1 class=\"title_favoritos\">${favorite.show.name}</h1><img class=\"img_favoritos\" src=\"${favorite.show.image.medium}\"/><i id=\"${favorite.show.id}\"></i></div></li>`;\n      }\n    }\n    \n }\n\n //Local Storage\n function setLocalStorage() {\n   localStorage.setItem('favorites', JSON.stringify(favorites));\n }\n \n function savedFilms() {\n   const local = JSON.parse(localStorage.getItem('favorites'));\n   if(local!==null){\n     favorites=local\n   }\n   //recupero el array de favoritos almacenado en ls\n  \n   //pinto la lista de favoritos con lo almacenado en ls\n   printFavorite(); \n\n }\n\n //Boton de borrar:\n \n function resetFav(){\n   //Ponemos el array de los favoritos vacío\n   favoriteFilms.innerHTML='';\n   //limpiados la lista con el localStorage\n   localStorage.clear('favorites');\n   paintFilms();\n\n }\n\n reset.addEventListener('click', resetFav);\n\n savedFilms();\n        \n\n\n"]}